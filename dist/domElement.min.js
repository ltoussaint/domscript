/*! domscript 2016-03-28 */
!function(a){a.Class("$.Dom.Abstract",function(b){return b.domElement,b.domContainer,b.oOwnerSvg,this.getDomElement=function(){return b.domElement},this.getValue=function(){return b.domElement.value||null},this.isChecked=function(){return b.domElement.checked||!1},this.check=function(){return a.isUndefined(b.domElement.checked)||(b.domElement.checked=!0),this},this.uncheck=function(){return a.isUndefined(b.domElement.checked)||(b.domElement.checked=!1),this},this.addClass=function(c){return a.addClass(b.domElement,c),this},this.removeClass=function(c){return a.removeClass(b.domElement,c),this},this.hasClass=function(c){return a.hasClass(b.domElement,c)},this.addStyle=function(c,d){return a.addStyle(b.domElement,c,d),this},this.addCss=function(c){return a.addCss(b.domElement,c),this},this.appendChild=function(a){return b.domElement.appendChild(a.getDomElement()),this},this.addEvent=function(c,d,e){return e=e||this,a.addEvent(b.domElement,c,function(b,c){b.$domTarget=a.Load("$.Dom.Element",b.target),d.call(e,b,c)}),this},this["delete"]=function(){return b.domElement.parentNode.removeChild(b.domElement),this},this.setOwnerSvg=function(a){return b.oOwnerSvg=a,this},this.isDomScript=!0,!0});a.Class("$.Dom.Element",function(b){function c(){var c=a.template(b.__template);this.html(c({$this:this,$that:b}))}b.__id=null,b.__container=null,b.__template=null,b.__class=null,this.__construct=function(d,e){if(a.isString(d))if(0===d.indexOf("#")){if(b.domElement=document.getElementById(d.substring(1)),null==b.domElement)throw new Error("Element with specified id not found : "+d)}else a.isUndefined(e)?b.domElement=document.createElement(d.toLowerCase()):b.domElement=document.createElementNS(e,d.toLowerCase());else a.isUndefined(d)?b.domElement=document.createElement("div"):b.domElement=d;if(a.isNull(b.__template)||c.call(this),a.isNull(b.__id)||b.domElement.setAttribute("id",b.__id),a.isNull(b.__class)||(b.domElement.className=b.__class),!a.isNull(b.__container))if(b.__container.isDomScript)b.__container.appendChild(this);else{var f=a.Load("$.Dom.Element",b.__container);f.appendChild(this)}return this},this.getDomElementFromTemplate=function(){var a=this.getTemplateContent(),c=new RegExp("^[ 	\r\n\f]*<([a-z]+)[^>]*>(.*)</\\1>","im"),d=c.exec(a);if(null==d)throw Error("Can't parse microtemplate");b.domElement=document.createElement(d[1]),b.domContent=d[2],this.reloadContent()},this.getTemplateContent=function(){if(0===b.__template.indexOf("<"))return b.__template;try{return document.getElementById(b.__template).innerHTML}catch(a){throw Error("Can't find microTemplate with id "+b.__template)}},this.getAttribute=function(c){return a.getAttribute(b.domElement,c)},this.setAttribute=function(c,d){return a.setAttribute(b.domElement,c,d),this},this.onClick=function(b){if(a.isFunction(b))return this.addEvent("click",b),this;throw new Exception("Onclick need callback function as first parameter.")},this.html=function(a){b.domElement.innerHTML=a},this.text=function(a){b.domElement.textContent=a},this.reloadTemplate=function(){a.isNull(b.__template)||c.call(this)}}).Extend("$.Dom.Abstract"),a.Class("$.Dom.ElementNS",function(b){this.__construct=function(c,d){return b.oOwnerSvg=null,b.aStyleList=[],a.isString(d)?b.domElement=document.createElementNS(c,d):b.domElement=d,this},this.getAttribute=function(a){return b.domElement.getAttributeNS(null,a)},this.setAttribute=function(a,c){return b.domElement.setAttributeNS(null,a,c)},this.addStyle=function(c,d){return a.addStyle(b.domElement,c,d),this},this.text=function(a){b.domElement.textContent=a},this.getOwnerSvg=function(){return b.oOwnerSvg},this.setOwnerSvg=function(a){b.oOwnerSvg=a;for(var c=0;c<b.aOwnerSvgFilters.length;c++)b.oOwnerSvg.attachFilter(b.aOwnerSvgFilters[c]);return this}}).Extend("$.Dom.Abstract"),a.Class("$.Dom.Image",function(b){var c;return this.__construct=function(d){c=d||null,b.domElement=new Image,a.isUndefined(b.container)||a.isUndefined(document.getElementById(b.container))||document.getElementById(b.container).appendChild(b.domElement)},this.setSrc=function(a){return b.domElement.src=a,this},this.setHeight=function(a){return b.domElement.height=a,this},this.setWidth=function(a){return b.domElement.width=a,this},this.load=function(){b.domElement.src=c},this.onload=function(a,b){return this.addEvent("load",a,b||this),this},!0}).Extend("$.Dom.Element"),a.Class("$.Dom.Form",function(b){function c(c){var d={};return a.each(b.domElement.elements,function(b){a.isEmpty(b.name)||(d[b.name]=a.Load("$.Dom.Form.Element",b))}),d}var d=this;this.__construct=function(b){if(a.isString(b)&&"form"!=b.toLowerCase())throw Error("Could only create form tag with Form class!");if(b.nodeType&&"FORM"!=b.tagName)throw Error("Could only create form tag with Form class");a.isUndefined(b)&&(b="form"),this.parentCall.call(d,"__construct",b)},this.onSubmit=function(d){a.addEvent(b.domElement,"submit",function(a){return a.preventDefault(),d(a,c(a))})}}).Extend("$.Dom.Element"),a.Class("$.Dom.Form.Element",function(b){this.value=function(c){return a.isUndefined(c)?b.domElement.value:(b.domElement.value=c,this)}}).Extend("$.Dom.Element"),a.Class("$.Dom.Body",function(a){this.__construct=function(){if(null==window.document.body)throw new Error("To use $.Dom.Body, you need to wait dom is ready");this.parentCall("__construct",window.document.body)}}).Extend("$.Dom.Element"),a.Class("$.Dom.Svg",function(b){var c="http://www.w3.org/2000/svg";b.oDefs=null,this.__construct=function(a,b){this.parentCall("__construct","svg",c),a&&b&&(this.setHeight(b),this.setWidth(a)),this.setAttribute("xmlns",c)},this.setHeight=function(a){this.setAttribute("height",a),/^[0-9]+$/.exec(a)&&(a+="px"),this.addStyle("height",a)},this.setWidth=function(a){this.setAttribute("width",a),/^[0-9]+$/.exec(a)&&(a+="px"),this.addStyle("width",a)},this.getAttribute=function(c){return a.getAttribute(b.domElement,c)},this.setAttribute=function(c,d){return a.setAttribute(b.domElement,c,d)},this.attachFilter=function(a){null===b.oDefs&&(b.oDefs=document.createElementNS(c,"defs"),b.domElement.appendChild(b.oDefs)),b.oDefs.appendChild(a.getDomElement())},this.appendChild=function(a){a.setOwnerSvg(this),b.domElement.appendChild(a.getDomElement())}}).Extend("$.Dom.Element"),a.Class("$.Dom.Svg.Abstract",function(c){var d=this;c.aOwnerSvgFilters=[],c.aChildrenOwnerSvg=[];var e="http://www.w3.org/2000/svg";this.SVG_TRANSFORM_UNKNOWN=0,this.SVG_TRANSFORM_MATRIX=1,this.SVG_TRANSFORM_TRANSLATE=2,this.SVG_TRANSFORM_SCALE=3,this.SVG_TRANSFORM_ROTATE=4,this.SVG_TRANSFORM_SKEWX=5,this.SVG_TRANSFORM_SKEWY=6,this.__construct=function(a,b){this.parentCall("__construct",e,a),c._initOptions(b)},c._initOptions=function(b){a.isUndefined(b)||a.isEmpty(b)||a.each(b,function(a,b){d.setAttribute(b,a)})},this.addTransformation=function(a){var b=this.getAttribute("transform"),c=/^([^(]+)\(/.exec(a)[1],d=new RegExp("\\s*\\b"+c+"\\b\\s*\\([^)]+\\)\\s*","i");b=b.replace(d,""),b+=" "+a;var b=this.setAttribute("transform",b);return this},this.attachClippath=function(b){var d=b.createId();this.setAttribute("clip-path","url(#"+d+")"),c.aOwnerSvgFilters.push(b),a.isUndefined(c.oOwnerSvg)||null==c.oOwnerSvg||c.oOwnerSvg.attachFilter(b)},this.attachFilter=function(b){var d=b.createId();this.setAttribute("filter","url(#"+d+")"),c.aOwnerSvgFilters.push(b),a.isUndefined(c.oOwnerSvg)||null==c.oOwnerSvg||c.oOwnerSvg.attachFilter(b)},c.setChildrenOwnerSvg=function(){a.each(c.aChildrenOwnerSvg,function(a){a.setOwnerSvg(c.oOwnerSvg)})},this.appendChild=function(b){console.log(this,b),console.log(this.getDomElement(),b.getDomElement()),c.domElement.appendChild(b.getDomElement()),c.aChildrenOwnerSvg.push(b),a.isUndefined(c.oOwnerSvg)||null==c.oOwnerSvg||b.setOwnerSvg(c.oOwnerSvg)},this.setOwnerSvg=function(a){c.oOwnerSvg=a;for(var b=0;b<c.aChildrenOwnerSvg.length;b++)c.aChildrenOwnerSvg[b].setOwnerSvg(a);for(var b=0;b<c.aOwnerSvgFilters.length;b++)c.oOwnerSvg.attachFilter(c.aOwnerSvgFilters[b]);return this},this.createId=function(){var a="fi"+b++;return d.setAttribute("id",a),a}}).Extend("$.Dom.ElementNS"),a.Class("$.Dom.Svg.Circle",function(b){this.__construct=function(b,c,d,e){e=e||{},a.extend(e,{cx:b,cy:c,r:d}),this.parentCall("__construct","circle",e)}}).Extend("$.Dom.Svg.Abstract"),a.Class("$.Dom.Svg.Group",function(a){this.__construct=function(a){var a=a||{};this.parentCall("__construct","g",a)}}).Extend("$.Dom.Svg.Abstract"),a.Class("$.Dom.Svg.Path",function(a){this.__construct=function(a,b){var b=b||{};this.parentCall("__construct","path",b),this.setAttribute("d",a)}}).Extend("$.Dom.Svg.Abstract"),a.Class("$.Dom.Svg.Polyline",function(a){this.__construct=function(a,b){var b=b||{};this.parentCall("__construct","polyline",b),this.setAttribute("points",a)}}).Extend("$.Dom.Svg.Abstract"),a.Class("$.Dom.Svg.Polygon",function(a){this.__construct=function(a,b){var b=b||{};this.parentCall("__construct","polygon",b),this.setAttribute("points",a)}}).Extend("$.Dom.Svg.Abstract"),a.Class("$.Dom.Svg.Rect",function(b){this.__construct=function(b,c,d,e,f){f=f||{},a.extend(f,{x:b,y:c,width:d,height:e}),this.parentCall("__construct","rect",f)}}).Extend("$.Dom.Svg.Abstract"),a.Class("$.Dom.Svg.Text",function(b){this.__construct=function(b,c,d,e){e=e||{},a.extend(e,{x:c,y:d}),this.parentCall("__construct","text",e),this.text(b)}}).Extend("$.Dom.Svg.Abstract"),a.Class("$.Dom.Svg.Defs.ClipPath",function(a){var c=this;this.__construct=function(){this.parentCall("__construct","clipPath")},this.addPath=function(a){this.appendChild(a)},a.createId=function(){var a="fi"+b++;return c.setAttribute("id",a),a}}).Extend("$.Dom.Svg.Abstract");var b=1;a.Class("$.Dom.Svg.Defs.Filter.Abstract",function(a){var c=this;this.createId=function(){var a="fi"+b++;return c.setAttribute("id",a),a}}).Extend("$.Dom.Svg.Abstract");a.Class("$.Dom.Svg.Defs.Filter.ColorMatrix",function(a){var b,c,d=this;this.__construct=function(d,e){b=d,c=e,this.parentCall("__construct","feColorMatrix"),a.initAttributes()},a.initAttributes=function(){d.setAttribute("type",b),d.setAttribute("values",c)},this.writeFilter=function(){}}).Extend("$.Dom.Svg.Defs.Filter.Abstract");var c=1;a.Class("$.Dom.Svg.Defs.Filter.FilterList",function(a){var b,d,e,f=this;this.__construct=function(c,f,g){b=c||"sIn, stdDeviationX, stdDeviationY",d=f||0,e=g||d,this.parentCall("__construct","filter");a.createId()},a.initAttributes=function(){this.setAttribute("in",b),d==e?this.setAttribute("stdDeviation",d):(this.setAttribute("stdDeviationX",d),this.setAttribute("stdDeviationY",e))},this.addFilter=function(a){return this.appendChild(a),this},a.createId=function(){var a="fi"+c++;return f.setAttribute("id",a),a}}).Extend("$.Dom.Svg.Defs.Filter.Abstract");a.Class("$.Dom.Svg.Defs.Filter.GaussianBlur",function(a){var b,c,d,e=this;this.__construct=function(e,f,g){b=e||"sIn, stdDeviationX, stdDeviationY",c=f||0,d=g||c,this.parentCall("__construct","feGaussianBlur"),a.initAttributes()},a.initAttributes=function(){e.setAttribute("in",b),c==d?e.setAttribute("stdDeviation",c):(e.setAttribute("stdDeviationX",c),e.setAttribute("stdDeviationY",d))},this.writeFilter=function(){}}).Extend("$.Dom.Svg.Defs.Filter.Abstract"),a.Class("$.Dom.Svg.Defs.Filter.Merge",function(a){this.__construct=function(){this.parentCall("__construct","feMerge")},this.addNode=function(a){this.appendChild(a)}}).Extend("$.Dom.Svg.Defs.Filter.Abstract"),a.Class("$.Dom.Svg.Defs.Filter.Merge.Node",function(a){this.__construct=function(b){this.parentCall("__construct","feMergeNode"),a._initOptions(b)},this.addNode=function(a){this.appendChild(a)}}).Extend("$.Dom.Svg.Defs.Filter.Abstract"),a.Class("$.Dom.Canvas",function(b){function c(){return b.context.globalAlpha=1,b.context.fillStyle="#FFFFFF",this}b.context,b.height=150,b.width=300,b.children=[],b.fillStyle=null,this.__construct=function(){this.parentCall("__construct","canvas")},this.display=function(){b.fillStyle&&(console.log("Display fill style"),b.context.fillStyle=b.fillStyle),console.log("Reload canvas");for(var a in b.children)for(var d in b.children[a])b.children[a][d].display(),c.call(this)},this.getContext=function(){return b.context},this.getHeight=function(){return b.height},this.setHeight=function(a){return b.height=a,b.domElement.setAttribute("height",b.height),this},this.getWidth=function(){return b.width},this.setWidth=function(a){return b.width=a,b.domElement.setAttribute("width",b.width),this},this.addChild=function(c,d){return d=d||1,a.isUndefined(b.children[d])&&(b.children[d]=[]),console.log("Add child",this),c.setCanvas(this),b.children[d].push(c),console.log(b.children),this},this.setFillStyle=function(a){return b.fillStyle=a,this},this.getFillStyle=function(){return b.fillStyle},b._initCanvas=function(){return b.context=b.domElement.getContext("2d"),this}}).Extend("$.Dom.Element"),a.Class("$.Dom.Canvas.DisplayObject",function(a){a.x=0,a.y=0,a.z=0,a.height=0,a.width=0,a.canvas,a.alpha=1,a.fillStyle=null,this.__construct=function(a){_loadOptions.call(this,a||{})},this.display=function(){return a.canvas.getContext().globalAlpha=a.alpha,console.log("Ok set alpha"),a.fillStyle&&(a.canvas.getContext().fillStyle=a.fillStyle,a.canvas.getContext().fillRect(0,0,a.width,a.height)),this},this.setCanvas=function(b){return a.canvas=b,this},this.setX=function(b){return a.x=b,this},this.getX=function(){return a.x},this.setY=function(b){return a.y=b,this},this.getY=function(){return a.y},this.setZ=function(b){return a.z=b,this},this.getZ=function(){return a.z},this.setHeight=function(b){return a.height=b,this},this.getHeight=function(){return a.height},this.setWidth=function(b){return a.width=b,this},this.getWidth=function(){return a.width},this.setAlpha=function(b){return a.alpha=b,this},this.getAlpha=function(){return a.alpha},this.setFillStyle=function(b){return a.fillStyle=b,this},this.getFillStyle=function(){return a.fillStyle}}),a.Class("$.Dom.Canvas.Image",function(b){function c(){return e=document.createElement("img"),e.onload=a.callback(function(){f=!0,this.display()},this),e.src=b.url,this}function d(a){return b.url=a.url||b.url,b.height=a.height||b.height,b.width=a.width||b.width,this}b.url="";var e,f=!1;this.__construct=function(a){d.call(this,a||{})},this.display=function(){1==f&&(console.log("Call parent display"),this.parentCall("display"),b.canvas.getContext().drawImage(e,b.x,b.y,b.width,b.height))},this.setUrl=function(a){return f=!1,b.url=a,c.call(this),this},this.getUrl=function(){return b.url}}).Extend("$.Dom.Canvas.DisplayObject"),a.Class("$.Dom.Canvas.Text",function(a){function b(){return a.canvas.getContext().font="10px sans-serif",a.canvas.getContext().textAlign="start",a.canvas.getContext().textBaseline="alphabetic",this}function c(b){return a.color=b.color||a.color,a.size=b.size||a.size,this}a.text="",a.color="#000000",a.size="10px",a.fontFamily="sans-serif",a.textAlign="start",a.textBaseline="alphabetic",a.strokeWidth=2,a.strokeColor="#FFFFFF",this.__construct=function(b,d){a.text=b,c.call(this,d||{})},this.display=function(){b.call(this);var c=a.canvas.getContext();return this.parentCall("display"),c.font=a.size+" "+a.fontFamily,c.textAlign=a.textAlign,c.textBaseline=a.textBaseline,console.log(a.color),parseInt(a.strokeWidth)>0?(c.fillStyle=a.strokeColor,c.strokeStyle=a.color,c.strokeText(a.text,a.x,a.y)):(c.fillStyle=a.color,c.fillText(a.text,a.x,a.y)),this},this.setSize=function(b){return a.size=b,this},this.getSize=function(){return a.size},this.setText=function(b){return a.text=b,this},this.getText=function(){return a.text}}).Extend("$.Dom.Canvas.DisplayObject")}(window.$);